<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <title>Bootstrap5 实例</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://api.damesck.net/api/bootstrap-5.3.0-alpha1-dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://api.damesck.net/api/bootstrap-5.3.0-alpha1-dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body>
<div class="sticky-top shadow mb-2" style="background-color:rgba(255,255,255,0.95)">
    <div class="container">
        <header class="d-flex flex-wrap pt-2 pb-2">
            <span class="fs-4 me-auto"><i class="fa fa-paper-plane text-primary" aria-hidden="true"></i>&nbsp;验证请求 - KLPBBS问卷</span>
            <a href="" class="btn btn-outline-success"><i class="fa fa-home"></i> 返回首页</a>
            <!--            <span class="d-flex fs-4 text-end"><button type="button" class="btn btn-outline-success btn-sm" onclick="copyText('我在玩国际版我的世界，用浏览器打开链接，内含200+免费国际版安卓安装包。快来和我一起体验Minecraft吧！(仅供体验，请支持正版)链接:\nhttps://mcapks.net')"><i class="fa fa-share-square-o" aria-hidden="true"></i>&nbsp;分享</button></span>-->
        </header>
    </div>
</div>
<br>
<!-- Flexbox container for aligning the toasts -->
<div id="toastContainer" aria-live="polite" aria-atomic="true" class="d-flex justify-content-center align-items-center w-100">

    <!-- Then put toasts within -->
    <div id="autoToast" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-autohide="false">
        <div class="toast-header">
            <i class="fa fa-close"></i>&nbsp;
            <strong class="me-auto">错误</strong>
            <small>授权登录</small>
<!--            <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>-->
        </div>
        <div class="toast-body">
            <button class="btn">
<!--                <span class="spinner-border spinner-border-sm"></span>-->
                授权登录出现了参数错误，请重新登陆！
            </button>
        </div>
        <script>
            function getQueryVariable(variable) {
                let query = window.location.search.substring(1);
                let vars = query.split("&");
                for (let i=0; i<vars.length; i++) {
                    let pair = vars[i].split("=");
                    if(pair[0] === variable) {
                        return pair[1];
                    }
                }
                return false;
            }

            let state = getQueryVariable("state");
            let tokenn = getQueryVariable("token");

            fetch(`https://wj.klpbbs.cn/api/oauth?state=${state}&token=${tokenn}`)
                .then(() => {
                    window.location.href = `/confirm.html`;
                })
                .catch(error => {
                    console.log('error', error);
                    setTimeout(() => {
                        window.location.href = "/access/";
                    }, 3000)
                });
        </script>
    </div>
</div>

<!-- Bootstrap JavaScript Bundle with Popper -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script>
    // JavaScript to automatically show the toast on page load
    let toastEl = document.getElementById('autoToast');
    let toast = new bootstrap.Toast(toastEl);

    // Show the toast automatically when the page loads
    document.addEventListener('DOMContentLoaded', function () {
        toast.show();
    });
</script>
<div class="container mt-3">
<p>2024版权所有 © KLPBBS 问卷</p>
</div>
</body>
</html>